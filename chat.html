<!DOCTYPE html>
<html>
<head>
  <title>Chat Room</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      background-color: #2f3136;
      color: #dcddde;
    }

    .chat-container {
      display: flex;
      flex-direction: column;
      height: 100vh;
    }

    .chat-header {
      background-color: #202225;
      padding: 15px;
      font-size: 20px;
      font-weight: bold;
      color: white;
      border-bottom: 1px solid #1e1f22;
    }

    .chat-log {
      flex-grow: 1;
      overflow-y: auto;
      padding: 15px;
    }

    .chat-message {
      margin-bottom: 15px;
      display: flex;
      align-items: flex-start;
    }

    .avatar {
      width: 40px;
      height: 40px;
      background-color: #7289da;
      border-radius: 50%;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      color: white;
      font-size: 18px;
    }

    .message-content {
      background-color: #36393f;
      padding: 10px 15px;
      border-radius: 10px;
      max-width: 600px;
    }

    .message-name {
      font-weight: bold;
      margin-bottom: 5px;
      color: #ffffff;
    }

    .chat-input {
      display: flex;
      padding: 10px;
      background-color: #40444b;
      border-top: 1px solid #1e1f22;
    }

    .chat-input input, .chat-input textarea {
      background-color: #303339;
      color: #dcddde;
      border: none;
      padding: 10px;
      border-radius: 5px;
      font-size: 14px;
      margin-right: 10px;
    }

    .chat-input input {
      width: 150px;
    }

    .chat-input textarea {
      flex-grow: 1;
      resize: none;
      height: 50px;
    }

    .chat-input button {
      background-color: #7289da;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    .chat-input button:hover {
      background-color: #5b6eae;
    }

    .name-prompt {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #2f3136;
    }

    .name-input-container {
      background-color: #40444b;
      padding: 20px;
      border-radius: 10px;
      color: #dcddde;
      text-align: center;
    }

    .name-input-container input {
      background-color: #303339;
      color: #dcddde;
      border: none;
      padding: 10px;
      border-radius: 5px;
      font-size: 14px;
    }

    .name-input-container button {
      background-color: #7289da;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
    }

    #waiting {
      color: #ffcc00;
      font-size: 18px;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="namePrompt" class="name-prompt">
    <div class="name-input-container">
      <h2>Enter your name to get started:</h2>
      <input id="nameInput" placeholder="Your name" />
      <button onclick="submitName()">Submit</button>
    </div>
  </div>

  <div class="chat-container" style="display: none;">
    <div class="chat-header">ðŸ’¬ Chat Room</div>
    <div id="waiting" style="display: none;">Waiting for verification...</div>

    <div id="chatLog" class="chat-log"></div>

    <div class="chat-input">
      <input id="chatName" placeholder="Your name" disabled />
      <textarea id="chatText" placeholder="Say something..." disabled></textarea>
      <button onclick="sendChat()" disabled>Send</button>
    </div>
  </div>

  <script>
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwLImmugDLVGkErhrIqiZPX6pym7v6EQJQwd7tqcz6hV1ha41Cs9mvHagO5RSmfKxjf/exec';
    let userName = '';

    async function submitName() {
      userName = document.getElementById('nameInput').value.trim();
      if (!userName) return alert('Please enter your name!');

      // Hide the name input and show waiting message
      document.getElementById('namePrompt').style.display = 'none';
      document.getElementById('waiting').style.display = 'block';

      await fetch(`${SCRIPT_URL}?action=sendVerificationEmail&name=${userName}`);
      
      checkIfVerified();
    }

    async function checkIfVerified() {
      const res = await fetch(`${SCRIPT_URL}?action=check
IfVerified&name=${userName}`);
const isVerified = await res.text();
if (isVerified === 'true') {
    document.getElementById('waiting').style.display = 'none';
    document.querySelector('.chat-container').style.display = 'block';
    document.getElementById('chatName').value = userName;
    document.getElementById('chatText').disabled = false;
    document.querySelector('button').disabled = false;
  } else {
    setTimeout(checkIfVerified, 5000); // Check every 5 seconds
  }
}

async function sendChat() {
  const message = document.getElementById('chatText').value.trim();
  if (!message) return;

  // Send the message to Google Sheets
  await fetch(`${SCRIPT_URL}?action=addMessage&name=${userName}&text=${message}`);
  document.getElementById('chatText').value = '';
  updateChatLog();
}

async function updateChatLog() {
  const res = await fetch(`${SCRIPT_URL}?action=getChat`);
  const data = await res.json();

  const chatLog = document.getElementById('chatLog');
  chatLog.innerHTML = '';

  data.messages.forEach(msg => {
    const messageElement = document.createElement('div');
    messageElement.classList.add('chat-message');
    messageElement.innerHTML = `<div class="avatar">${msg.name[0]}</div>
                                <div class="message-content">
                                  <div class="message-name">${msg.name}</div>
                                  <div class="message-text">${msg.text}</div>
                                </div>`;
    chatLog.appendChild(messageElement);
  });
}
</script>
</body>
</html>
```